<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Flappy Bird Simple</title>
  <style>
    canvas {
      display: block;
      margin: 0 auto;
      background: skyblue;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="400" height="600"></canvas>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    // Constantes
    const WIDTH = canvas.width;
    const HEIGHT = canvas.height;
    const GRAVITY = 0.6;
    const FLAP = -10;
    const PIPE_WIDTH = 60;
    const PIPE_GAP = 150;
    const BIRD_SIZE = 30;

    // Bird
    let birdY = HEIGHT / 2;
    let birdVelocity = 0;

    // Pipes
    let pipes = [];
    let pipeSpeed = 2;
    let frameCount = 0;

    // Ground
    let groundY = HEIGHT - 40;
    const groundImg = new Image();
    groundImg.src = "https://i.imgur.com/wP6kB4o.png"; // Imagen de suelo
    let groundReady = false;
    groundImg.onload = () => {
      groundReady = true;
    };
    groundImg.onerror = () => {
      console.warn("No se pudo cargar la imagen del suelo.");
    };

    // Funciones
    function drawBird() {
      ctx.fillStyle = "blue";
      ctx.fillRect(80, birdY, BIRD_SIZE, BIRD_SIZE);
    }

    function drawPipes() {
      ctx.fillStyle = "green";
      pipes.forEach(pipe => {
        ctx.fillRect(pipe.x, 0, PIPE_WIDTH, pipe.top);
        ctx.fillRect(pipe.x, pipe.top + PIPE_GAP, PIPE_WIDTH, HEIGHT);
      });
    }

    function drawGround() {
      if (groundReady) {
        for (let x = 0; x < WIDTH; x += 32) {
          ctx.drawImage(groundImg, x, groundY);
        }
      } else {
        ctx.fillStyle = "#DEB887"; // fallback visual
        ctx.fillRect(0, groundY, WIDTH, HEIGHT - groundY);
      }
    }

    function update() {
      birdVelocity += GRAVITY;
      birdY += birdVelocity;

      // Suelo
      if (birdY + BIRD_SIZE > groundY) {
        birdY = groundY - BIRD_SIZE;
        birdVelocity = 0;
      }

      // Tubos
      pipes.forEach(pipe => {
        pipe.x -= pipeSpeed;
      });

      // Remover tubos fuera de pantalla
      pipes = pipes.filter(pipe => pipe.x + PIPE_WIDTH > 0);

      // AÃ±adir tubos nuevos
      if (frameCount % 90 === 0) {
        const top = Math.random() * (HEIGHT - PIPE_GAP - 100) + 20;
        pipes.push({ x: WIDTH, top: top });
      }

      frameCount++;
    }

    function draw() {
      ctx.clearRect(0, 0, WIDTH, HEIGHT);
      drawBird();
      drawPipes();
      drawGround();
    }

    function loop() {
      update();
      draw();
      requestAnimationFrame(loop);
    }

    // Input
    document.addEventListener("keydown", e => {
      if (e.code === "Space") {
        birdVelocity = FLAP;
      }
    });

    // Iniciar el juego
    loop();
  </script>
</body>
</html>
