<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Esquiva Mangonio</title>
  <style>
    body {
      margin: 0;
      background: #def;
      overflow: hidden;
      font-family: sans-serif;
    }
    canvas {
      display: block;
      margin: auto;
      background: #b2ebf2;
      border: 5px solid #333;
    }
    #gameOver, #winMessage {
      position: absolute;
      top: 30%;
      width: 100%;
      text-align: center;
      font-size: 2em;
      color: red;
      display: none;
    }
    #score {
      position: absolute;
      top: 10px;
      left: 20px;
      font-size: 20px;
      font-weight: bold;
    }
    #skinButton, #rouletteButton {
      position: absolute;
      bottom: 20px;
      font-size: 16px;
      padding: 10px 20px;
      background-color: #333;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    #skinButton {
      left: 20px;
    }
    #rouletteButton {
      right: 20px;
    }
    #skinMenu, #rouletteMenu {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      border: 2px solid #000;
      padding: 20px;
      z-index: 10;
      max-width: 600px;
      width: 90%;
      max-height: 70vh;
      overflow-y: auto;
      box-shadow: 0 0 15px rgba(0,0,0,0.5);
    }
    .skin-option {
      display: inline-block;
      width: 120px;
      margin: 10px;
      text-align: center;
    }
    .skin-option img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border: 2px solid #000;
      border-radius: 10px;
    }
    .skin-option button {
      margin-top: 5px;
      padding: 5px 10px;
    }
    #closeMenu, #closeRouletteMenu {
      position: absolute;
      top: 5px;
      right: 10px;
      font-size: 18px;
      background: red;
      color: white;
      border: none;
      padding: 5px 10px;
      cursor: pointer;
    }
    .reward-display {
      text-align: center;
      margin-top: 20px;
    }
    .reward-display img {
      width: 100px;
      height: 100px;
    }
    .reward-display button {
      margin-top: 10px;
      padding: 10px 20px;
    }
  </style>
</head>
<body>
  <div id="gameOver">Haz muerto, Mangonio estÃ¡ muy triste ðŸ˜­<br>Presiona "R" para reiniciar</div>
  <div id="winMessage">Ganaste, Mangonio estÃ¡ orgulloso ðŸš‰<br>Puntaje mÃ¡ximo alcanzado</div>
  <div id="score">Puntos: 0</div>
  <button id="skinButton">Skins</button>
  <button id="rouletteButton"><img src="ruleta.png" alt="Ruleta" width="30" height="30"/>Ruleta</button>
  <div id="skinMenu"><button id="closeMenu">X</button></div>
  <div id="rouletteMenu"><button id="closeRouletteMenu">X</button>
    <div style="text-align: center;">
      <img src="ruleta.png" alt="Ruleta" style="width:200px;"><br>
      <p>Â¡Gira la ruleta para ganar una recompensa cada 30 minutos!</p>
      <ul style="text-align: left;">
        <li>200 Mango Coins</li>
        <li>400 Mango Coins</li>
        <li>800 Mango Coins</li>
        <li>2400 Mango Coins</li>
        <li>Skin: Mangonio Frozen</li>
        <li>Skin: Mangonio FaraÃ³n</li>
        <li>Skin: RenÃ© Cromo</li>
      </ul>
      <button id="spinRoulette">Girar</button>
      <div class="reward-display" id="rewardDisplay"></div>
    </div>
  </div>
  <canvas id="game" width="800" height="300"></canvas>

  <script>
    const skins = [
      { name: "Mangonio", file: "mangonio.png" },
      { name: "Mangonio Fino", file: "mangoniofino.png" },
      { name: "RenÃ©", file: "RenÃ©.png" },
      { name: "Gil", file: "gil.png" },
      { name: "Pablito", file: "pablito.png" },
      { name: "Kuchau", file: "kuchau.png" },
      { name: "Polariza", file: "polariza.png" },
      { name: "Gil Shiny", file: "GilShiny.png", requiresCode: true },
      { name: "mangonio.exe", file: "mangonio.exe.png" },
      { name: "Mangonio Frozen", file: "mangoniofrozen.png", rewardOnly: true },
      { name: "Mangonio FaraÃ³n", file: "mangoniofaraon.png", rewardOnly: true },
      { name: "RenÃ© Cromo", file: "renecromo.png", rewardOnly: true }
    ];

    const unlockedSkins = JSON.parse(localStorage.getItem('unlockedSkins') || '[]');
    const mangonioImg = new Image();
    mangonioImg.src = skins[0].file;

    const skinMenu = document.getElementById("skinMenu");
    const skinButton = document.getElementById("skinButton");
    const closeMenu = document.getElementById("closeMenu");
    const rouletteMenu = document.getElementById("rouletteMenu");
    const rouletteButton = document.getElementById("rouletteButton");
    const closeRouletteMenu = document.getElementById("closeRouletteMenu");
    const spinRoulette = document.getElementById("spinRoulette");
    const rewardDisplay = document.getElementById("rewardDisplay");

    skinButton.onclick = showSkinMenu;
    closeMenu.onclick = () => skinMenu.style.display = "none";
    rouletteButton.onclick = () => rouletteMenu.style.display = "block";
    closeRouletteMenu.onclick = () => rouletteMenu.style.display = "none";

    function showSkinMenu() {
      skinMenu.innerHTML = '<button id="closeMenu">X</button>';
      skins.forEach(skin => {
        if (skin.rewardOnly && !unlockedSkins.includes(skin.name)) return;
        const div = document.createElement("div");
        div.className = "skin-option";
        div.innerHTML = `
          <img src="${skin.file}" alt="${skin.name}" />
          <div>${skin.name}</div>
          <button>Seleccionar</button>
        `;
        div.querySelector("button").onclick = () => {
          if (skin.requiresCode) {
            const code = prompt("Introduce el cÃ³digo para desbloquear esta skin:");
            if (code !== "GilGuapo") return alert("CÃ³digo incorrecto");
          }
          mangonioImg.src = skin.file;
          skinMenu.style.display = "none";
        };
        skinMenu.appendChild(div);
      });
      document.getElementById("closeMenu").onclick = () => skinMenu.style.display = "none";
      skinMenu.style.display = "block";
    }

    const rewards = [
      { type: 'coins', amount: 200 },
      { type: 'coins', amount: 400 },
      { type: 'coins', amount: 800 },
      { type: 'coins', amount: 2400 },
      { type: 'skin', name: 'Mangonio Frozen', file: 'mangoniofrozen.png' },
      { type: 'skin', name: 'Mangonio FaraÃ³n', file: 'mangoniofaraon.png' },
      { type: 'skin', name: 'RenÃ© Cromo', file: 'renecromo.png' }
    ];

    spinRoulette.onclick = () => {
      const lastSpin = parseInt(localStorage.getItem('lastRouletteSpin') || '0');
      if (Date.now() - lastSpin < 30 * 60 * 1000) {
        return alert("Debes esperar 30 minutos entre giros");
      }
      localStorage.setItem('lastRouletteSpin', Date.now().toString());
      const reward = rewards[Math.floor(Math.random() * rewards.length)];
      rewardDisplay.innerHTML = '';
      if (reward.type === 'coins') {
        rewardDisplay.innerHTML = `
          <p>Â¡Has ganado ${reward.amount} Mango Coins!</p>
          <img src="coin.png" alt="Coins">
          <button onclick="
            let coins = parseInt(localStorage.getItem('coins') || '0');
            coins += ${reward.amount};
            localStorage.setItem('coins', coins);
            document.getElementById('rouletteMenu').style.display = 'none';
          ">Reclamar</button>
        `;
      } else {
        unlockedSkins.push(reward.name);
        localStorage.setItem('unlockedSkins', JSON.stringify([...new Set(unlockedSkins)]));
        rewardDisplay.innerHTML = `
          <p>Â¡Has desbloqueado la skin: ${reward.name}!</p>
          <img src="${reward.file}" alt="${reward.name}">
          <button onclick="document.getElementById('rouletteMenu').style.display = 'none'">Reclamar</button>
        `;
      }
    }
  </script>
</body>
</html>
